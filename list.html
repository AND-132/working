<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬¸ì„œ ëª©ë¡ | Official Archive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body{
      background:#f7f9fc;
      font-family:'Segoe UI', system-ui;
      margin:0; padding:40px;
    }
    h1{font-size:22px; margin-bottom:20px;}
    #fileList{
      display:flex; flex-direction:column; gap:10px; margin-top:20px;
    }
    .item{
      background:#fff; padding:14px 16px;
      border:1px solid #ddd; border-radius:8px;
      display:flex; justify-content:space-between; align-items:center;
    }
    a.btn{
      padding:6px 12px;
      background:#3A7DFF; color:#fff;
      border-radius:8px;
      text-decoration:none;
      font-size:14px;
    }
  </style>
</head>

<body>
  <h1 id="title"></h1>
  <div id="fileList">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>

  <a href="official.html" style="display:block;margin-top:30px;color:#666;">â† ëŒì•„ê°€ê¸°</a>

<script type="module">
import { app } from "./firebase-init.js";
import { getStorage, ref, listAll, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

const storage = getStorage(app);
const fileList = document.getElementById("fileList");

const path = new URLSearchParams(location.search).get("path");
document.getElementById("title").innerText = "ğŸ“‚ " + path;

async function loadFiles() {
  const folderRef = ref(storage, path);
  const res = await listAll(folderRef);

  fileList.innerHTML = "";

  // ğŸ“ í•˜ìœ„ í´ë”
  res.prefixes.forEach(folder => {
    fileList.innerHTML += `
      <div class="item">
        ğŸ“ ${folder.name}
        <a class="btn" href="list.html?path=${folder.fullPath}">ì—´ê¸°</a>
      </div>
    `;
  });

  // ğŸ“„ íŒŒì¼
  for (const file of res.items) {
    const url = await getDownloadURL(file);
    fileList.innerHTML += `
      <div class="item">
        ğŸ“„ ${file.name}
        <a class="btn" target="_blank" href="${url}">ë³´ê¸°</a>
      </div>
    `;
  }
}

loadFiles();
</script>

</body>
</html>
