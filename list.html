<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¬¸ì„œ ëª©ë¡</title>

<style>
body{font-family:'Pretendard',sans-serif;background:#F6F7FB;margin:0;padding:24px;}
#fileList{margin-top:20px;}
.item{padding:12px;border-bottom:1px solid #E5E7EB;display:flex;justify-content:space-between;}
.btn{padding:6px 12px;border-radius:8px;background:#3A7DFF;color:#fff;text-decoration:none;font-size:14px;}
</style>
</head>

<body>

<h2 id="title"></h2>
<div id="loading">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
<div id="fileList"></div>
<a href="official.html" class="btn" style="margin-top:20px;display:inline-block;">â† ëŒì•„ê°€ê¸°</a>

<script type="module">
import { storage } from "./firebase-init.js";
import { ref, listAll, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-storage.js";

const path = new URLSearchParams(window.location.search).get("path");
document.getElementById("title").innerText = "ğŸ“‚ " + path;

async function load(){
  const res = await listAll(ref(storage, path));
  document.getElementById("loading").style.display="none";

  // í´ë” í‘œì‹œ
  res.prefixes.forEach(folder=>{
    fileList.innerHTML += `<div class="item">ğŸ“ ${folder.name}<a class="btn" href="list.html?path=${folder.fullPath}">ì—´ê¸°</a></div>`;
  });

  // íŒŒì¼ í‘œì‹œ
  for(const item of res.items){
    const url = await getDownloadURL(item);
    fileList.innerHTML += `<div class="item">ğŸ“„ ${item.name}<a class="btn" href="${url}" target="_blank">ë³´ê¸°</a></div>`;
  }
}
load();
</script>

</body>
</html>
